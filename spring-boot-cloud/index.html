<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Bootiful Microservices</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/black.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section>
            <h1><img src="img/spring-boot.png"/> + <img src="img/spring-cloud.png"/></h1>
            <h2>Bootiful Microservices</h2>
        </section>
        <section>
            <img src="img/spring-boot.png"/>
            <h1>Spring Boot</h1>
            <q>Takes an opinionated view of building production-ready Spring applications.
                Spring Boot favors convention over configuration and is designed to get you up and running as quickly as
                possible.</q>
        </section>
        <section>
            <h1>Features</h1>
            <ul>
                <li class="fragment">Create stand-alone Spring applications</li>
                <li class="fragment">Embed Tomcat, Jetty or Undertow directly (no need to deploy WAR files)</li>
                <li class="fragment">Provide opinionated 'starter' POMs to simplify your Maven configuration</li>
                <li class="fragment">Automatically configure Spring whenever possible</li>
                <li class="fragment">Provide production-ready features such as metrics, health checks and externalized
                    configuration
                </li>
                <li class="fragment">Absolutely no code generation and no requirement for XML configuration</li>
            </ul>
        </section>
        <section>
            <section>
                <a href="https://start.spring.io/">http://start.spring.io</a>
            </section>
            <section>
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Go over pom.xml file + to parents</li>
                        <li>Perform maven clean install and show jar file</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <h2>@SpringBootApplication</h2>
            <pre><code class="fragment hljs" data-trim contenteditable>
@Configuration
@ComponentScan
@EnableAutoConfiguration
            </code></pre>
        </section>
        <section>
            <section>
                <h2>Auto-configuration</h2>
                <p>Spring Boot auto-configuration attempts to automatically configure your Spring application based on
                    the jar dependencies that you have added.</p>
            </section>
            <section>
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Go to main, SpringBootApplication</li>
                        <li>Show how autoconfiguration works (spring-boot-autoconfigure: spring.factories)</li>
                        <li>Demo adding ElasticSearch</li>
                        <li>Also show @Conditional params</li>
                        <li>Explain runtime dependency advantage</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <section>
                <img src="img/dev-tools.png"/>
                <h2>Developer tools</h2>
                <ul>
                    <li class="fragment">Property defaults</li>
                    <li class="fragment">Automatic restart</li>
                    <li class="fragment">LiveReload</li>
                    <li class="fragment">...</li>
                </ul>
            </section>
            <section>
            <!--<section data-background="https://media.giphy.com/media/l3q2Z6S6n38zjPswo/giphy.gif">-->
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Show pom dependency</li>
                        <li>Show http://localhost:8080/env for sensible defaults</li>
                        <li>Demo Automatic Restart</li>
                        <li>Explain two classloaders (base / restart)</li>
                        <li>Demo LiveReload (use code in html)</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <section>
                <h2>Externalized Configuration</h2>
                <ul>
                    <li class="fragment">*.properties</li>
                    <li class="fragment">*.yaml</li>
                    <li class="fragment">Environment variables</li>
                    <li class="fragment">Command line arguments</li>
                    <li class="fragment">Inject using @Value</li>
                    <li class="fragment">Profiles</li>
                </ul>
                <aside class="notes">
                    Explain burden of properties before
                </aside>
            </section>
            <section>
                <h2>Externalized Configuration</h2>
                <a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config">http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config</a>
                <aside class="notes">
                    Explain profiles
                </aside>
            </section>
            <section>
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Write RestController printing out a property, showing how easy it is to write a REST.
                            Use Auto-Restart functionality!!!</li>
                        <li>show application.properties, change intellij runconfiguration for env_value</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <section>
                <img src="img/testing.jpg"/>
                <h2>Testing</h2>
            </section>
            <section>
                <ul>
                    <li class="fragment">JUnit — The de-facto standard for unit testing Java applications.
                    <li class="fragment">Spring Test & Spring Boot Test — Utilities and integration test support for Spring Boot
                        applications.
                    </li>
                    <li class="fragment">AssertJ — A fluent assertion library.</li>
                    <li class="fragment">Hamcrest — A library of matcher objects (also known as constraints or predicates).</li>
                    <li class="fragment">Mockito — A Java mocking framework.</li>
                    <li class="fragment">JSONassert — An assertion library for JSON.</li>
                    <li class="fragment">JsonPath — XPath for JSON.</li>
                </ul>
            </section>
            <section>
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Show pom dependency</li>
                        <li>Write test with TestRestTemplate</li>
                        <li>Use RANDOM_PORT</li>
                        <li>Use @LocalServerPort</li>
                        <li>Use @MockBean/@SpyBean, show without mocking and using @Mock first</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <section>
                <img src="img/actuator.png"/>
                <h4>Spring Boot Actuator - Production-ready features</h4>
            </section>
            <section>
                <ul>
                    <li class="fragment">Auditing</li>
                    <li class="fragment">Health</li>
                    <li class="fragment">Metrics</li>
                </ul>
            </section>
            <section>
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Show pom dependency</li>
                        <li>show /actuator and beyond</li>
                        <li>http://flux-rprod-cpp-r2.flatns.net/api/history/health</li>
                        <li>http://flux-rprod-cpp-r2.flatns.net/api/engine/actuator</li>
                        <li>http://flux-rprod-cpp-r2.flatns.net/api/engine/health</li>
                        <li>http://flux-rprod-cpp-r2.flatns.net/api/engine/metrics</li>
                        <li>http://flux-rprod-cpp-r2.flatns.net/api/engine/liquibase</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <h2>And many many more...</h2>
            <a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/">Spring Boot Reference
                Guide</a>
        </section>
        <section>
            <img src="img/spring-cloud.png"/>
            <h1>Spring Cloud</h1>
            <q>Spring Cloud provides tools for developers to quickly build some of the common patterns in
                distributed
                systems.</q>
        </section>
        <section>
            <section>
                <h1>Cloud Native Applications</h1>
                <q>Style of application development that encourages easy adoption of best practices in the areas of
                    continuous delivery and value-driven development.</q>
            </section>
            <section>
                <a href="https://12factor.net/">The Twelve Factors</a>
            </section>
            <section>
                <p>Spring Cloud facilitates this in a number of specific ways</p>
            </section>
        </section>
        <section>
            <h1>Features</h1>
            <ul>
                <li class="fragment">Distributed/versioned configuration</li>
                <li class="fragment">Service registration and discovery</li>
                <li class="fragment">Routing</li>
                <li class="fragment">Service-to-service calls</li>
                <li class="fragment">Load balancing</li>
                <li class="fragment">Circuit Breakers</li>
                <li class="fragment">Global locks</li>
                <li class="fragment">Leadership election and cluster state</li>
                <li class="fragment">Distributed messaging</li>
            </ul>
        </section>
        <section>
            <section>
                <h1>Spring Cloud Config</h1>
            </section>
            <section>
                <ul>
                    <li class="fragment">externalized configuration in a distributed system</li>
                    <li class="fragment">server and client-side support</li>
                    <li class="fragment">central place to manage external properties for applications across all environments</li>
                    <li class="fragment">uses git by default</li>
                </ul>
            </section>
            <section>
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Start Flux Discovery Service</li>
                        <li>Start Flux Configuration Service</li>
                        <li>Show git repository https://bitbucket.tomtomgroup.com/projects/WORKFLOW/repos/flux-config/browse</li>
                        <li>http://localhost:8888/flux-engine-service/local</li>
                        <li>Explain bootstrap.yml</li>
                        <li>Explain it can be combined with normal spring boot config</li>
                        <li>Explain how it accesses it</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <h1>Spring Cloud Netflix</h1>
            <img src="img/netflix.png"/>
        </section>
        <section>
            <section>
                <img src="img/archimedes.jpg"/>
                <h1>Service Discovery: Eureka</h1>
            </section>
            <section>
                <p>Service Discovery is one of the key tenets of a micro-service based architecture. Trying to hand
                    configure each client or some form of convention can be very difficult to do and can be very
                    brittle.</p>
            </section>
            <section>
                <img src="img/eureka.jpg"/>
            </section>
            <section>
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Show Flux discovery code</li>
                        <li>Show Client (@EnableDiscoveryClient, bootstrap-local.yml)</li>
                        <li>http://localhost:8761/</li>
                        <li>Explain how config registers</li>
                        <li>Explain two bootstrap strategies</li>
                        <li>http://rprod-cpp-flux-r2-201.flatns.net:8761/</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <section>
                <img src="img/hystrix.png"/>
                <h1>Circuit Breaker: Hystrix</h1>
            </section>
            <section>
                <ul>
                    <li class="fragment">pom.xml: spring-cloud-starter-hystrix</li>
                    <li class="fragment">@EnableCircuitBreaker</li>
                    <li class="fragment">@HystrixCommand</li>
                </ul>
            </section>
            <section>
                <img src="img/hystrix-dashboard.png"/>
            </section>
            <section>
                <p>Turbine is an application that aggregates all of the relevant /hystrix.stream endpoints into a
                    combined /turbine.stream for use in the Hystrix Dashboard. Individual instances are located via
                    Eureka.</p>
            </section>
        </section>
        <section>
            <section>
                <img src="img/ribbon.png"/>
                <h1>Client Side Load Balancer: Ribbon</h1>
            </section>
            <section>
                <ul>
                    <li class="fragment">Can be used with or without Eureka</li>
                    <li class="fragment">Eliminate the middle hop (e.g. HAProxy)</li>
                </ul>
            </section>
        </section>
        <section>
            <section>
                <img src="img/declarative.jpg"/>
                <h1>Declarative REST Client: Feign</h1>
            </section>
            <section>
                <q>Feign is a declarative web service client. It makes writing web service clients easier. To use Feign
                    create an interface and annotate it.</q>
            </section>
            <section>
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Show FeignConfiguration in flux-ui-service</li>
                        <li>Explain that by default it uses ribbon, combined with Eureka, if discovered.</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <section>
                <img src="img/zuul.jpg"/>
                <h1>Router and Filter: Zuul</h1>
            </section>
            <section>
                Netflix uses Zuul for the following:
                <ul>
                    <li>Authentication</li>
                    <li>Insights</li>
                    <li>Stress Testing</li>
                    <li>Canary Testing</li>
                    <li>Dynamic Routing</li>
                    <li>Service Migration</li>
                    <li>Load Shedding</li>
                    <li>Security</li>
                    <li>Static Response handling</li>
                    <li>Active/Active traffic management</li>
                </ul>
            </section>
            <section>
                <p>Zuul is an API Gateway</p>
                <q>An API Gateway is a server that is the single entry point into the system. The API Gateway
                    encapsulates the internal system architecture and provides an API that is tailored to each client.
                    It might have other responsibilities such as authentication, monitoring, load balancing, caching,
                    request shaping and management, and static response handling.</q>
            </section>
            <section>
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Show FluxGatewayService</li>
                        <li>Show flux-gateway-service.yml</li>
                        <li>Refer to http://flux-rprod-cpp-r2.flatns.net/api/engine/health</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <img src="img/eureka-zuul-ribbon.png"/>
        </section>
        <section>
            <section>
                <img src="img/stream.png"/>
                <h1>Spring Cloud Stream</h1>
            </section>
            <section>
                <q>Spring Cloud Stream is a framework for building message-driven micro-service applications</q>
            </section>
            <section>
                <p>The code itselve is unaware of the underlying binder implementation!</p>
                <img src="img/spring-cloud-stream.png"/>
            </section>
            <section>
                <q>Spring Cloud Stream provides Binder implementations for:</q>
                <ul>
                    <li class="fragment">Kafka</li>
                    <li class="fragment">Rabbit MQ</li>
                    <li class="fragment"><a href="https://github.com/spring-cloud?utf8=%E2%9C%93&q=spring-cloud-stream-binder&type=&language=">Others</a></li>
                </ul>
            </section>
            <section>
                <img src="img/demo.png"/>
                <aside class="notes">
                    <ul>
                        <li>Show EngineEventProducer/EngineEventConsumer</li>
                        <li>Show configuration files</li>
                        <li>Explain consumer groups</li>
                    </ul>
                </aside>
            </section>
        </section>
        <section>
            <h2>And many many more...</h2>
            <a href="http://cloud.spring.io/spring-cloud-static/Camden.SR2/">Spring Cloud Reference
                Guide</a>
        </section>
        <section>
            <h1>Questions?</h1>
        </section>
        <section data-background="img/thank-you.gif">
            <h1>Thank you</h1>
        </section>
    </div>
</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>
    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        history: true,

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
            {src: 'plugin/markdown/marked.js'},
            {src: 'plugin/markdown/markdown.js'},
            {src: 'plugin/notes/notes.js', async: true},
            {
                src: 'plugin/highlight/highlight.js', async: true, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            }
        ]
    });
</script>
</body>
</html>
